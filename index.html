<html>
  <head>
    <title>Level Editor</title>
    <style>
    
      * {
	font-family: sans-serif;
      }
      
      .options {
	display: none;
	visibility: hidden;
      }
      
      .editorMain {
	display: none;
	visibility: hidden;
      }
      
      .choose {
	display: none;
	visibility: hidden;
      }
      
      .options:target {
	display: block;
	visibility: visible;
	
	background: #EEEEEE;
	border: 1px solid #777777;
	border-radius: 0.5em;
	
	margin-top: 10%;
	margin-left: -5%;
	
	width: 30%;
	min-width: 30em;
	height: 25%;
	min-height: 15em;
      }
      
      .editorMain:target {
	display: block;
	visibility: visible;
	
	background: #FFFFFF;
	border: none;
	border-radius: 0.5em;
	
	width: 70%;
	min-width: 60em;
	max-width: 70em;
	height: 98%
      }
      
      .choose:target {
	display: block;
	visibility: visible;
	
	background: #EEEEEE;
	border: 1px solid #777777;
	border-radius: 0.5em;
	
	margin-top: 5%;
	margin-left: -5%;
	
	width: 30em;
	height: 25.5em;
      }
      
      .optionsTable {
	border: none;
	
	width: 100%;
	
	margin-bottom: 1em;
      }
      
      .optionsInputText {
	color: #444444;
	background: #FAFAFA;
	border: 1px solid #777777;
	border-radius: 3px;
	
	width: 100%;
	height: 2em;
	
	float: right;
	margin-right: 1em;
	margin-bottom: 0.5em;
	
	padding-left: 0.3em;
	
	font-weight: 600;
      }
      
      .optionsInputText:hover {
	border: 1px solid #AAAAAA;
      }
      
      .optionsText {
	float: right;
	padding-right: 1.5em;
	
	font-weight: 600;
      }
      
      .optionsInputRadio {
	font-weight: 500;
	
	margin-right: 0.3em;
      }
      
      .optionsInputRadio:checked {
	font-weight: 800;
      }
      
      .optionsClose {
	color: #009900;
	background: #AAFFAA;
	border: 1px solid #009900;
	border-radius: 5px;
	
	text-decoration: none;
	
	float: right;
	margin-right: 1em;
	
	padding: 0.2em 0.5em 0.2em 0.5em;
	
	font-size: 1.5em;
      }
      
      .optionsClose:hover {
	color: #00AA00;
	background: #BBFFBB;
      }
      
      .editorTitle {	
	width: 100%;
	height: 5%;
      }
      
      .editorTitleTable {
	width: 99%;
	height: 99%;
      }
      
      .editorTitleTableTd {
	width: 33%;
      }
      
      .editorSpecialButton {
	color: #005500;
	background: none;
	border: 1px solid #FFFFFF;
	border-radius: 5px;
	
	text-decoration: none;
	
	padding: 0.1em 0.4em 0.1em 0.4em;
	
	cursor: pointer;
	
	font-size: 1.5em;
      }
      
      .editorSpecialButton:hover {
	color: #007700;
	border: 1px solid #BBCCBB;
      }
      
      .editorTitleText {
	font-size: 1.5em;
	font-weight: 800;
	
	margin-top: 0.5em;
	margin-bottom: 0.5em;
      }
      
      .editorMenuBar {
	background: #EEEEEE;
	border: 1px solid #CCCCCC;
	border-radius: 5px;
	
	width: 98%;
	height: 10%;
	
	margin-left: 0.4%;
	margin-top: 0.5em;
	margin-bottom: 0.5em;
      }
      
      .editorMenuBarTable {
	border: none;
	
	width: 100%;
	height: 100%;
      }
      
      .editorMenuBarTableTd {
	/*width: 12.4%;*/
      }
      
      .chooseButton {
	color: #000000;
	background: #BBBBBB;
	border: 1px solid #888888;
	border-radius: 5px;
	
	height: 100%;
	width: 100%;
	
	padding: 0.9em;
	
	text-decoration: none;
	
	cursor: pointer;
      }
      
      .chooseButton:hover {
	color: #222222;
	background: #CCCCCC;
	border: 1px solid #999999;
      }
      
      .button {
	color: #000000;
	background: #DDDDDD;
	border: 1px solid #AAAAAA;
	border-radius: 5px;
	
	height: 100%;
	width: 100%;
	
	padding: 0.9em;
	
	text-decoration: none;
	
	cursor: pointer;
      }
      
      .button:hover {
	color: #222222;
	background: #E9E9E9;
	border: 1px solid #BBBBBB;
      }
      
      .editorContentContainer {
	background: #000000;
	border: 1px solid #AAAAAA;
	border-radius: 5px;
	
	width: 98%;
	height: 80%;
	
	margin-left: 0.4%;
	margin-bottom: 0.5em;
      }
      
      .editorContent {
	background: #555555;
	
	width: 99%;
	height: 97%;
	
	margin: 0.5%;
      }
      
      .chooseTable {
	border: none;
	
	width: 100%;
	
	margin-bottom: 1em;
      }
      
      .chooseTd {
	width: 33%;
      }
      
      .chooseImg {
	border: 1px solid #999999;
	
	width: 7.2em;
	margin-bottom: 1em;
      }
    </style>
    <!-- Import script fow canvas_draw -->
    <script src="canvas_draw.js"></script>
    <script src="canvas_preview.js"></script>
    <!-- Script for level-editor -->
    <script>
      // Vars
      var mouseDown = false;
      var blockChosen = 0;
      var activeX, activeY, activeDir = "W", isActive = false;
      // Update size listener
      window.onresize = updateSize;
      // Dummy init for example
      // Look into the documentation what this one does
      function init()
      {
        cpInit("canvas", true);
        updateSize();
      }
      
      function update()
      {
	// draw
	cpUpdate();
      }
      
      function updateSize()
      {
	// set canvas size
	document.getElementById("canvas").width = document.getElementById("canvas").offsetWidth;
	document.getElementById("canvas").height = document.getElementById("canvas").offsetHeight;
	// draw
      	cpUpdate();
      }
      
      function onMouseDown(event)
      {
	mouseDown = true;
	setActive(event.clientX, event.clientY, true);
	// update
	update();
      }
      
      function onMouseUp(event)
      {
	mouseDown = false;
      }
      
      function onMouseMove(event)
      {
	if(mouseDown)
	{
	  setActive(event.clientX, event.clientY, false);
	  cpSetTile(activeX, activeY, blockChosen, activeDir);
	  // update
	  update();
	}
      }
      
      function setActive(canvasX, canvasY, canDeselect)
      {
	// Get tile dimension
	tiledim = cpGetTileDimension();
	// Calculate tile
	/*ar xOffset = ((_cpCanvasObj.width - (_cpMapData.General.Size.X * tiledim)) / 2);
	var yOffset = ((_cpCanvasObj.height - (_cpMapData.General.Size.Y * tiledim)) / 2);*/
	var tileX = Math.floor(((canvasX - document.getElementById("canvas").offsetLeft) - ((_cpCanvasObj.width - (_cpMapData.General.Size.X * tiledim)) / 2)) / tiledim);
	var tileY = Math.floor(((canvasY - document.getElementById("canvas").offsetTop) - ((_cpCanvasObj.height - (_cpMapData.General.Size.Y * tiledim)) / 2)) / tiledim);
	// set as active or disable active tile if same
	if(isActive)
	{
	  if(activeX == tileX && activeY == tileY && canDeselect)
	  {
	    isActive = false;
	  }
	  else
	  {
	    activeX = tileX;
	    activeY = tileY;
	  }
	}
	else
	{
	  isActive = true;
	  activeX = tileX;
	  activeY = tileY;
	}
      }
      
      function setActiveTile()
      {
	if(isActive)
	{
	  cpSetTile(activeX, activeY, blockChosen, activeDir);
	  update();
	}
      }
      
      function rotateActiveTile()
      {
	if(isActive)
	{
	  
	}
      }
    </script>
  </head>
  <body onload="init();">
    <div align="center">
      <div class="options" id="game" align="center">
	<p style="font-size: 1.2em; font-weight: 600;">Map-Einstellungen</p>
	<table class="optionsTable">
	  <tr>
	    <td>
	      <p class="optionsText">Map-Name:</p>
	    </td>
	    <td>
	      <input type="text" class="optionsInputText" />
	    </td>
	  </tr>
	  <tr>
	    <td>
	      <p class="optionsText">Autor:</p>
	    </td>
	    <td>
	      <input type="text" class="optionsInputText" />
	    </td>
	  </tr>
	  <tr>
	    <td>
	      <p class="optionsText">Schwierigkeit:</p>
	    </td>
	    <td>
	      <input type="radio" class="optionsInputRadio" name="difficultyRadio" value="Leicht">Leicht</input>
	      <input type="radio" class="optionsInputRadio" name="difficultyRadio" value="Mittel" checked="true">Mittel</input>
	      <input type="radio" class="optionsInputRadio" name="difficultyRadio" value="Schwer">Schwer</input>
	    </td>
	  </tr>
	</table>
	<a class="optionsClose" href="#editor" onclick="init()">OK</a>
      </div>
    </div>
   
    <div align="center">
      <div class="editorMain" id="editor">
	<div class="editorTitle">
	  <table class="editorTitleTable">
	    <tr>
	      <td class="editorTitleTableTd">
		<a class="editorSpecialButton" style="float: left;" href="#game">Optionen</a>
	      </td>
	      <td class="editorTitleTableTd">
		<div align="center">
		  <span class="editorTitleText">Level-Editor</span>
		</div>
	      </td>
	      <td class="editorTitleTableTd">
		<a class="editorSpecialButton" style="float: right;">Fertig</a>
	      </td>
	    </tr>
	  </table>
	</div>
	<div class="editorMenuBar">
	  <table class="editorMenuBarTable">
	    <tr>
	      <td class="editorMenuBarTableTd">
		<div align="left" style="padding-left: 1em;"><a class="chooseButton" href="#chooseBlock">Block w&auml;hlen</a></div>
	      </td>
	      <td class="editorMenuBarTableTd">
		<div align="center"><a class="button" onclick="setActiveTile()">Setzen</a></div>
	      </td>
	      <td class="editorMenuBarTableTd">
		<div align="center"><a class="button">Richtung</a></div>
	      </td>
	      <td class="editorMenuBarTableTd">
		<div align="center"><a class="button">Aussehen</a></div>
	      </td>
	      <td class="editorMenuBarTableTd">
		<div align="center"><a class="button" onclick="blockChosen = 17;">START</a></div>
	      </td>
	      <td class="editorMenuBarTableTd">
		<div align="center"><a class="button" onclick="blockChosen = 16;">ENDE</a></div>
		</td>
	      <td class="editorMenuBarTableTd">
		<div align="center"><a class="button" onclick="blockChosen = 15;">WEG</a></div>
	      </td>
	      <td class="editorMenuBarTableTd">
		<div align="center"><a class="button" onclick="blockChosen = 0;">FREI</a></div>
	      </td>
	    </tr>
	  </table>
	</div>
	<div class="editorContentContainer" align="center">
	  <!-- CONVAS FOR CONTENT -->
	    <canvas class="editorContent" id="canvas"
		onmousedown="onMouseDown(event)"
		onmouseup="onMouseUp(event)"
		onmousemove="onMouseMove(event)">
	      <b>
		<!-- Message if canvas doesn't work -->You can't use this leveleditor :/<br />
		Check if your browser provides <span style="color:#ff0000;">canvases</span>.
	      </b>
	    </canvas>
	  <!-- IMAGES FOR CP -->
	  <img src="img/tiles/standard.png" width="0" height="0" id="img_tile" />
	  <img src="img/tiles/up.png" width="0" height="0" id="img_up" />
	  <img src="img/tiles/down.png" width="0" height="0" id="img_down" />
	  <img src="img/tiles/left.png" width="0" height="0" id="img_left" />
	  <img src="img/tiles/right.png" width="0" height="0" id="img_right" />
	  <img src="img/tiles/start.png" width="0" height="0" id="img_start" />
	  <img src="img/tiles/end.png" width="0" height="0" id="img_end" />
	</div>
      </div>
    </div>
    
    <div align="center">
      <div class="choose" id="chooseBlock" align="center">
	<p style="font-size: 1.2em; font-weight: 600;">Block w&auml;hlen</p>
	<table class="chooseTable">
	  <tr>
	    <td class="chooseTd">
	      <div align="center"><a href="#editor" onclick="blockChosen = 1;"><img class="chooseImg" src="img/1.png"></a></div>
	    </td>
	    <td class="chooseTd">
	      <div align="center"><a href="#editor" onclick="blockChosen = 2;"><img class="chooseImg" src="img/2.png"></a></div>
	    </td>
	    <td class="chooseTd">
	      <div align="center"><a href="#editor" onclick="blockChosen = 3;"><img class="chooseImg" src="img/3.png"></a></div>
	    </td>
	  </tr>
	  <tr>
	    <td class="chooseTd">
	      <div align="center"><a href="#editor" onclick="blockChosen = 4;"><img class="chooseImg" src="img/4.png"></a></div>
	    </td>
	    <td class="chooseTd">
	      <div align="center"><a href="#editor" onclick="blockChosen = 5;"><img class="chooseImg" src="img/5.png"></a></div>
	    </td>
	    <td class="chooseTd">
	      <div align="center"><a href="#editor" onclick="blockChosen = 9;"><img class="chooseImg" src="img/9.png"></a></div>
	    </td>
	  </tr>
	</table>
	<a class="optionsClose" href="#editor">Abbrechen</a>
      </div>
    </div>
  </body>
</html>
